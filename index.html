<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Curso PM-AL - Plataforma Completa</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --azul-pm: #4682B4;
      --azul-claro: #2563EB;
      --cinza-claro: #F3F4F6;
      --background: #FFFFFF;
      --button-bg: var(--cinza-claro);
      --button-hover: #e0e0e0;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }
    body {
      background-color: var(--background);
      color: #333;
      transition: background 0.3s, color 0.3s;
    }
    .header {
      background: var(--background);
      padding: 1rem 2rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .header button {
      background: var(--button-bg);
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
      color: inherit;
    }
    .header button:hover {
      background: var(--button-hover);
    }
    .hero {
      background-color: #1F2937;
      color: white;
      padding: 4rem 2rem;
      text-align: center;
    }
    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
    }
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      padding: 4rem 2rem;
    }
    .feature-card {
      text-align: center;
      padding: 2rem;
      border-radius: 15px;
      background-color: var(--cinza-claro);
      transition: transform 0.3s;
    }
    .feature-card:hover {
      transform: translateY(-5px);
    }
    .disciplinas {
      padding: 4rem 2rem;
      background-color: var(--cinza-claro);
    }
    .disciplinas-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .disciplina-item {
      background-color: white;
      padding: 1.5rem;
      border-radius: 10px;
      text-align: center;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      text-decoration: none;
      color: inherit;
      display: block;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      cursor: pointer;
      border: none;
    }
    .disciplina-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      background-color: #f8f9fa;
    }
    .ferramentas {
      padding: 4rem 2rem;
    }
    .ferramenta-item {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 2rem;
      padding: 2rem;
      background-color: var(--cinza-claro);
      border-radius: 15px;
      transition: transform 0.3s;
      cursor: pointer;
    }
    .ferramenta-icon {
      font-size: 2.5rem;
      min-width: 60px;
    }
    .dashboards {
      padding: 4rem 2rem;
      background-color: white;
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 3rem;
      margin-top: 2rem;
    }
    .dashboard-card {
      background: var(--cinza-claro);
      padding: 2rem;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      position: relative;
    }
    .time-filter {
      position: absolute;
      top: 1rem;
      right: 1rem;
      display: flex;
      gap: 0.5rem;
    }
    .time-filter-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      background-color: #e0e0e0;
      transition: all 0.3s;
      color: inherit;
    }
    .active-time-filter {
      background-color: var(--azul-pm);
      color: white;
    }
    .progress-ring {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: conic-gradient(var(--azul-pm) 75%, #708090 0);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 1.5rem auto;
      font-size: 1.5rem;
      font-weight: bold;
    }
    .subject-bar {
      height: 10px;
      background: #e0e0e0;
      border-radius: 5px;
      margin: 1rem 0;
      position: relative;
    }
    .subject-progress {
      height: 100%;
      background: var(--azul-pm);
      width: 65%;
      border-radius: 5px;
      transition: width 0.5s ease;
    }
    @media (max-width: 768px) {
      .disciplinas-grid,
      .dashboard-grid,
      .features {
        grid-template-columns: 1fr;
      }
      .hero {
        padding: 4rem 1rem;
      }
      .hero h1 {
        font-size: 2rem;
      }
    }
    /* Estilos para a Modal Pomodoro */
    .pomodoro-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1001;
      justify-content: center;
      align-items: center;
    }
    .pomodoro-content {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      position: relative;
    }
    .close-modal {
      position: absolute;
      top: 1rem;
      right: 1rem;
      cursor: pointer;
      font-size: 1.5rem;
    }
    /* Dark Mode Styles */
    .dark-mode {
      --background: #1F2937;
      --cinza-claro: #374151;
      color: #E5E7EB;
    }
    .dark-mode a {
      color: #E5E7EB;
    }
    .dark-mode .header {
      box-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    .dark-mode .header button {
      background: #4B5563;
      color: #E5E7EB;
    }
    .dark-mode .header button:hover {
      background: #6B7280;
    }
    .dark-mode .disciplina-item {
      background-color: #1F2937;
      border: 1px solid #4B5563;
    }
    .dark-mode .disciplina-item:hover {
      background-color: #374151;
    }
    .dark-mode .time-filter-btn {
      background-color: #4B5563;
      color: #E5E7EB;
    }
    .dark-mode .pomodoro-content {
      background-color: #374151;
      color: #E5E7EB;
    }
    /* Corre√ß√£o: Dashboard com fundo escuro no modo noturno */
    .dark-mode .dashboards {
      background-color: var(--background);
    }
  </style>
</head>
<body>
  <header class="header">
    <h1>Estudo PM-AL</h1>
    <div>
      <button onclick="toggleDarkMode()" style="margin-right: 1rem;">üåì Modo Noturno</button>
      <button onclick="openPomodoro()">‚è±Ô∏è Iniciar Pomodoro</button>
    </div>
  </header>
  <!-- Modal Pomodoro -->
  <div class="pomodoro-modal" id="pomodoroModal">
    <div class="pomodoro-content">
      <span class="close-modal" onclick="closePomodoro()">&times;</span>
      <h2>Cron√¥metro Pomodoro</h2>
      <div class="timer" style="font-size: 3rem; margin: 1rem 0; font-family: monospace;">
        <span id="minutes">25</span>:<span id="seconds">00</span>
      </div>
      <div class="timer-buttons" style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem;">
        <button class="timer-btn" id="start" style="padding: 0.8rem 1.5rem; border: none; border-radius: 5px; cursor: pointer; background-color: #28a745; color: white;"><i class="fas fa-play"></i></button>
        <button class="timer-btn" id="pause" style="padding: 0.8rem 1.5rem; border: none; border-radius: 5px; cursor: pointer; background-color: #ffc107; color: white;"><i class="fas fa-pause"></i></button>
        <button class="timer-btn" id="reset" style="padding: 0.8rem 1.5rem; border: none; border-radius: 5px; cursor: pointer; background-color: #dc3545; color: white;"><i class="fas fa-undo"></i></button>
      </div>
    </div>
  </div>
  <section class="hero">
    <h1>Bora!</h1>
    <p style="margin-bottom: 1rem; font-size: 1.1rem;">Hoje √© sem acochambrar.</p>
  </section>
  <section class="dashboards">
    <h2 style="text-align: center; margin-bottom: 2rem;">Desempenho dos Usu√°rios</h2>
    <div class="dashboard-grid">
      <!-- Dashboard Jo√£o Pedro -->
      <div class="dashboard-card">
        <div class="time-filter">
          <button class="time-filter-btn active-time-filter" onclick="switchTimeFrame(this, 'joao')">Total</button>
          <button class="time-filter-btn" onclick="switchTimeFrame(this, 'joao')">Hoje</button>
        </div>
        <h3>üë§ Jo√£o Pedro</h3>
        <div class="progress-ring" id="joao-progress">75%</div>
        <div class="stats">
          <p>üéØ Acur√°cia Geral: <span id="joao-acuracia">82%</span></p>
          <p>‚úÖ Quest√µes Corretas: <span id="joao-correct">148</span>/<span id="joao-total">180</span></p>
          <div class="subject-bar">
            <div class="subject-progress" id="joao-subject1" style="width: 65%"></div>
          </div>
          <p>Legisla√ß√£o PM-AL</p>
          <div class="subject-bar">
            <div class="subject-progress" id="joao-subject2" style="width: 80%"></div>
          </div>
          <p>Portugu√™s</p>
        </div>
      </div>
  <!-- Dashboard Jos√© Ger√¥nimo -->
  <div class="dashboard-card">
    <div class="time-filter">
      <button class="time-filter-btn active-time-filter" onclick="switchTimeFrame(this, 'jose')">Total</button>
      <button class="time-filter-btn" onclick="switchTimeFrame(this, 'jose')">Hoje</button>
    </div>
    <h3>üë§ Jos√© Ger√¥nimo</h3>
    <div class="progress-ring" id="jose-progress">89%</div>
    <div class="stats">
      <p>üéØ Acur√°cia Geral: <span id="jose-acuracia">91%</span></p>
      <p>‚úÖ Quest√µes Corretas: <span id="jose-correct">205</span>/<span id="jose-total">225</span></p>
      <div class="subject-bar">
        <div class="subject-progress" id="jose-subject1" style="width: 92%"></div>
      </div>
      <p>Direito Constitucional</p>
      <div class="subject-bar">
        <div class="subject-progress" id="jose-subject2" style="width: 78%"></div>
      </div>
      <p>Matem√°tica</p>
    </div>
  </div>
</div>
  </section>
  <section class="features">
    <div class="feature-card">
      <h3>üìö Material Completo</h3>
      <p>Apostilas, videoaulas e resumos atualizados para todas as disciplinas</p>
    </div>
    <div class="feature-card">
      <h3>üìù Simulados Personalizados</h3>
      <p>Monte seus pr√≥prios simulados e acompanhe seu desempenho</p>
    </div>
    <div class="feature-card">
      <h3>üë• Comunidade Ativa</h3>
      <p>Interaja com outros candidatos e tire suas d√∫vidas</p>
    </div>
  </section>
  <section class="disciplinas">
    <h2 style="text-align: center; margin-bottom: 1rem;">Disciplinas Dispon√≠veis</h2>
    <div class="disciplinas-grid">
      <a href="LINK_DRIVE_PORTUGUES" class="disciplina-item" target="_blank">L√≠ngua Portuguesa</a>
      <a href="LINK_DRIVE_INFORMATICA" class="disciplina-item" target="_blank">No√ß√µes de Inform√°tica</a>
      <a href="LINK_DRIVE_LEGISLACAO" class="disciplina-item" target="_blank">Legisla√ß√£o PM-AL</a>
      <a href="LINK_DRIVE_MATEMATICA" class="disciplina-item" target="_blank">Matem√°tica</a>
      <a href="LINK_DRIVE_CIENCIAS_SOCIAIS" class="disciplina-item" target="_blank">Ci√™ncias Sociais</a>
      <a href="LINK_DRIVE_DIREITO_ADM" class="disciplina-item" target="_blank">Direito Administrativo</a>
      <a href="LINK_DRIVE_DIREITO_CONST" class="disciplina-item" target="_blank">Direito Constitucional</a>
      <a href="LINK_DRIVE_PROCESSO_PENAL" class="disciplina-item" target="_blank">Processo Penal</a>
      <a href="LINK_DRIVE_DIREITOS_HUMANOS" class="disciplina-item" target="_blank">Direitos Humanos</a>
    </div>
  </section>
  <section class="ferramentas">
    <h2 style="text-align: center; margin-bottom: 2rem;">Ferramentas de Estudo</h2>
    <div class="ferramenta-item" onclick="openPomodoro()">
      <span class="ferramenta-icon">‚è±Ô∏è</span>
      <div>
        <h3>Cron√¥metro Pomodoro</h3>
        <p>T√©cnica de estudo de 25 minutos com intervalos programados</p>
      </div>
    </div>
    <div class="ferramenta-item">
      <span class="ferramenta-icon">üìà</span>
      <div>
        <h3>An√°lise de Desempenho</h3>
        <p>Gr√°ficos detalhados e relat√≥rios de progresso</p>
      </div>
    </div>
  </section>
  <footer style="background: #1F2937; color: white; padding: 3rem; text-align: center; margin-top: 4rem;">
    <p>¬© 2024 Plataforma de Estudos PM-AL - Todos os direitos reservados</p>
  </footer>
  <script>
    // Dados iniciais (ser√£o sobrescritos com os registros do Notion)
    const notionUsers = {
      joao: {
        total: { subjects: {} },
        hoje: { subjects: {} }
      },
      jose: {
        total: { subjects: {} },
        hoje: { subjects: {} }
      }
    };

    function switchTimeFrame(btn, user) {
      const buttons = btn.parentElement.querySelectorAll('button');
      buttons.forEach(b => b.classList.remove('active-time-filter'));
      btn.classList.add('active-time-filter');
      
      const timeFrame = btn.textContent.toLowerCase();
      const userData = notionUsers[user][timeFrame];
      const dashboard = btn.closest('.dashboard-card');
      
      let disciplina;
      if (user === 'joao') {
        disciplina = 'Legisla√ß√£o PM-AL';
      } else if (user === 'jose') {
        disciplina = 'Direito Constitucional';
      }
      
      if (userData.subjects[disciplina]) {
        const dados = userData.subjects[disciplina];
        dashboard.querySelector('.progress-ring').textContent = dados.acuracia + '%';
        dashboard.querySelector(`#${user}-acuracia`).textContent = dados.acuracia + '%';
        dashboard.querySelector(`#${user}-correct`).textContent = dados.certas;
        dashboard.querySelector(`#${user}-total`).textContent = dados.total;
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    // L√≥gica do Cron√¥metro Pomodoro via Modal
    let timer;
    let isPaused = false;
    let minutes = 25;
    let seconds = 0;

    function updateDisplay() {
      document.getElementById("minutes").textContent = String(minutes).padStart(2, '0');
      document.getElementById("seconds").textContent = String(seconds).padStart(2, '0');
    }

    function startTimer() {
      if (!timer) {
        timer = setInterval(() => {
          if (!isPaused) {
            if (seconds === 0) {
              if (minutes === 0) {
                clearInterval(timer);
                alert("Tempo esgotado!");
                resetTimer();
                return;
              } else {
                minutes--;
                seconds = 59;
              }
            } else {
              seconds--;
            }
            updateDisplay();
          }
        }, 1000);
      }
    }

    function pauseTimer() {
      isPaused = !isPaused;
      document.getElementById('pause').innerHTML = isPaused 
        ? '<i class="fas fa-play"></i>' 
        : '<i class="fas fa-pause"></i>';
    }

    function resetTimer() {
      clearInterval(timer);
      timer = null;
      isPaused = false;
      minutes = 25;
      seconds = 0;
      updateDisplay();
      document.getElementById('pause').innerHTML = '<i class="fas fa-pause"></i>';
    }

    function openPomodoro() {
      document.getElementById('pomodoroModal').style.display = 'flex';
    }

    function closePomodoro() {
      document.getElementById('pomodoroModal').style.display = 'none';
      resetTimer();
    }

    document.getElementById('start').addEventListener('click', startTimer);
    document.getElementById('pause').addEventListener('click', pauseTimer);
    document.getElementById('reset').addEventListener('click', resetTimer);

    // Define os links das disciplinas conforme a vers√£o original
    const driveLinks = {
      'L√≠ngua Portuguesa': 'https://drive.google.com/drive/folders/16eAPcQBg61L6uSVrEKLdj_JVydBZzXRE?usp=drive_link',
      'No√ß√µes de Inform√°tica': '#',
      'Legisla√ß√£o PM-AL': 'https://drive.google.com/drive/folders/17-GzLcsxbKVBOOEFPibtJRg7m9_AAgTO?usp=drive_link',
      'Matem√°tica': 'https://drive.google.com/drive/folders/16AAqfUGczvHyszz8G4BfmomRw3ZpCHze?usp=drive_link',
      'Ci√™ncias Sociais': '#',
      'Direito Administrativo': '#',
      'Direito Constitucional': 'https://drive.google.com/drive/folders/1CLCmZdu9RFomIRq_BiKsVeF0d_J62PK-?usp=drive_link',
      'Processo Penal': 'https://drive.google.com/drive/folders/1k5J_FuF_24m7Emg8JsUUamhrBGQoZMPM?usp=drive_link',
      'Direitos Humanos': '#'
    };

    document.querySelectorAll('.disciplina-item').forEach(item => {
      const disciplina = item.textContent.trim();
      item.href = driveLinks[disciplina] || '#';
    });

    // Integra√ß√£o com o Notion
    async function fetchNotionData() {
      const token = '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';
      const databaseId = '19fc133b75d9805595f1dda1da75f696';
      const response = await fetch(`https://api.notion.com/v1/databases/${databaseId}/query`, {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Notion-Version': '2022-06-28',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({}) 
      });
      const data = await response.json();
      return data;
    }

    async function updateDashboardFromNotion() {
      try {
        const notionData = await fetchNotionData();
        const updatedUsers = {};
        
        notionData.results.forEach(item => {
          const nomeProp = item.properties.Nome;
          const userName = nomeProp && nomeProp.select ? nomeProp.select.name : '';
          const userKey = userName.split(" ")[0].toLowerCase();

          const periodoProp = item.properties.Per√≠odo;
          const periodo = periodoProp && periodoProp.select ? periodoProp.select.name : '';
          const periodKey = periodo.toLowerCase();

          const disciplinaProp = item.properties.Disciplina;
          const disciplina = disciplinaProp && disciplinaProp.select ? disciplinaProp.select.name : '';

          const acuracia = item.properties.Acur√°cia.number;
          const certas = item.properties.Certas.number;
          const totalQuestions = item.properties.Total.number;

          if (!updatedUsers[userKey]) {
            updatedUsers[userKey] = { total: { subjects: {} }, hoje: { subjects: {} } };
          }
          updatedUsers[userKey][periodKey].subjects[disciplina] = {
            acuracia: acuracia,
            certas: certas,
            total: totalQuestions
          };
        });
        
        Object.assign(notionUsers, updatedUsers);
        
        if (notionUsers.joao && notionUsers.joao.total.subjects['Legisla√ß√£o PM-AL']) {
          const dados = notionUsers.joao.total.subjects['Legisla√ß√£o PM-AL'];
          document.getElementById('joao-progress').textContent = dados.acuracia + '%';
          document.getElementById('joao-acuracia').textContent = dados.acuracia + '%';
          document.getElementById('joao-correct').textContent = dados.certas;
          document.getElementById('joao-total').textContent = dados.total;
        }
        if (notionUsers.jose && notionUsers.jose.total.subjects['Direito Constitucional']) {
          const dados = notionUsers.jose.total.subjects['Direito Constitucional'];
          document.getElementById('jose-progress').textContent = dados.acuracia + '%';
          document.getElementById('jose-acuracia').textContent = dados.acuracia + '%';
          document.getElementById('jose-correct').textContent = dados.certas;
          document.getElementById('jose-total').textContent = dados.total;
        }
      } catch (error) {
        console.error("Erro ao buscar dados do Notion:", error);
      }
    }

    window.addEventListener('load', () => {
      updateDashboardFromNotion();
    });
  </script>
</body>
</html>
